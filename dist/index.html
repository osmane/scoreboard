<!doctype html>
<html lang="en">
  <head>
    <title>billiards scoreboard</title>
    <link rel="icon" type="image/png" href="favicon.png" />
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="description" content="billiards scoreboard" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sakura.css/css/sakura.css" type="text/css">
  </head>

  <body>
    <h1>Billiards</h1>
    <h2>Play</h2>
    <p>
      <a href="https://tailuge.github.io/billiards/dist/?ruletype=snooker"
        >Snooker</a
      >
      <a href="https://tailuge.github.io/billiards/dist/?ruletype=nineball"
        >9-Ball</a
      >
      <a href="https://tailuge.github.io/billiards/dist/?ruletype=threecushion"
        >3-Cushion</a
      >
      <a href="https://tailuge.github.io/billiards/dist/?ruletype=fourteenone"
        >Straight</a
      >
    </p>
    <h2>Recent breaks</h2>
    <p>
      <a href="./replay/1">ðŸŽ±</a>
      <a href="./replay/2">ðŸŽ±</a>
      <a href="./replay/3">ðŸŽ±</a>
      <a href="./replay/4">ðŸŽ±</a>
      <a href="./replay/5">ðŸŽ±</a>
      <a href="./replay/6">ðŸŽ±</a>
      <a href="./replay/7">ðŸŽ±</a>
      <a href="./replay/8">ðŸŽ±</a>
      <a href="./replay/9">ðŸŽ±</a>
      <a href="./replay/10">ðŸŽ±</a>
      <a href="./replay/11">ðŸŽ±</a>
    </p>

    <div class="chart">
      <canvas id="chart"></canvas>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@^2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@^1"></script>

    <script type="module">
      const response = await fetch("https://tailuge-billiards.cyclic.app/usage")
      const data = await response.json()
      const labels = data.map((item) => Date.parse(item.props.created))
      const snooker = data.map((item) => item.props.snooker ?? null)
      const nineball = data.map((item) => item.props.nineball ?? null)
      const fourteenone = data.map((item) => item.props.fourteenone ?? null)
      const threecushion = data.map((item) => item.props.threecushion ?? null)
      const total = data.map(
        (item) => (item.props.play ?? 0) + (item.props.replay ?? 0)
      )
      const multidata = {
        labels: labels,
        datasets: [
          {
            label: "Snooker",
            data: snooker,
          },
          {
            label: "3-Cushion",
            data: threecushion,
          },
          {
            label: "9-ball",
            data: nineball,
          },
          {
            label: "Straight pool",
            data: fourteenone,
          },
          {
            label: "Total games",
            data: total,
            borderWidth: 0.5,
          },
        ],
      }
      const config = {
        type: "line",
        data: multidata,
        options: {
          responsive: true,
          scales: {
            x: {
              type: "time",
              time: {
                unit: 'day',
              },
              title: {
                display: true,
                text: "Date",
              },
            },
            y: {
              title: {
                display: true,
                text: "Games",
              },
            },
          },
        },
      }
      const ctx = document.getElementById("chart")
      new Chart(ctx, config)
    </script>
  </body>
</html>
